(function(e){function t(t){for(var o,i,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)i=r[u],s[i]&&p.push(s[i][0]),s[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],o=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(o=!1)}o&&(n.splice(t--,1),e=i(i.s=a[0]))}return e}var o={},s={app:0},n=[];function i(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=o,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(a,o,function(t){return e[t]}.bind(null,o));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://alivc-demo.aliyuncs.com/resource/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"19e6":function(e,t,a){},2017:function(e,t,a){"use strict";var o=a("3b76"),s=a.n(o);s.a},"224f":function(e,t,a){},3507:function(e,t,a){e.exports=a.p+"img/cover_empty.daca6cf0.png"},"36fb":function(e,t,a){},"3b76":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("7f7f"),a("a481");var o=a("795b"),s=a.n(o),n=a("7618"),i=(a("551c"),a("2b0e")),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("router-view")],1)},l=[],c={name:"app",components:{}},d=c,u=(a("5c0b"),a("2877")),p=Object(u["a"])(d,r,l,!1,null,null,null);p.options.__file="App.vue";var f=p.exports,v=a("bc3a"),m=a.n(v),h=(a("f5df"),a("a41b"),a("8c4f")),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login"},[a("div",{staticClass:"login-wrap"},[a("p",{staticClass:"label"},[e._v("登录")]),a("div",{staticClass:"wrap"},[a("el-form",{ref:"loginForm",attrs:{size:"small",model:e.formData,rules:e.rules,"hide-required-asterisk":!0}},[a("el-form-item",{attrs:{label:"账号",prop:"userName"}},[a("el-input",{attrs:{placeholder:"请输入登录账号"},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName",t)},expression:"formData.userName"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"输入登录密码"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1),a("el-form-item",[a("el-button",{attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.submitForm}},[e._v("登录")])],1)],1)],1)])])},b=[],w=(a("097d"),a("4328")),y=a.n(w),_={data:function(){return{loading:!1,formData:{userName:"",password:""},rules:{userName:[{required:!0,message:"请输入登录账号",trigger:"blur"}],password:[{required:!0,message:"输入登录密码",trigger:"blur"}]}}},methods:{submitForm:function(){var e=this,t=this.$refs.loginForm;t.validate(function(t){if(!t)return!1;e.loading=!0,e.axios.post("/console/user/login",y.a.stringify(e.formData)).then(function(t){var a=t.data;localStorage.setItem("token",a.data.consoleToken),e.$router.replace("/videos")}).catch(e.serviceError).finally(function(){e.loading=!1})})}}},k=_,x=(a("2017"),Object(u["a"])(k,g,b,!1,null,null,null));x.options.__file="index.vue";var C=x.exports,S=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",{staticClass:"main-container"},[o("el-aside",{staticClass:"main-aside",attrs:{width:e.isCollapse?"65px":"250px"}},[o("div",{staticClass:"menu-title"},[o("img",{attrs:{src:a("9d64")}}),e.isCollapse?e._e():o("span",{staticClass:"nowrap"},[e._v("趣视频管理后台")])]),o("el-menu",{staticClass:"main-menu",attrs:{collapse:e.isCollapse,"default-active":e.activeIndex,"background-color":"#001529","text-color":"#ddd",router:""}},[o("el-menu-item",{attrs:{index:"list",route:{path:"/videos"}}},[o("i",{staticClass:"el-icon-document"}),o("span",{attrs:{slot:"title"},slot:"title"},[e._v("视频列表")])]),o("el-menu-item",{attrs:{index:"recommend",route:{path:"/videos/recommend"}}},[o("i",{staticClass:"el-icon-star-off"}),o("span",{attrs:{slot:"title"},slot:"title"},[e._v("推荐视频")])])],1),o("div",{staticClass:"collapse-menu",on:{click:e.toggleCollapse}},[o("span",{directives:[{name:"show",rawName:"v-show",value:!e.isCollapse,expression:"!isCollapse"}]},[e._v("收起")]),o("i",{staticClass:"el-icon-d-arrow-left",class:{collapse:e.isCollapse}})])],1),o("el-container",[o("el-header",{staticClass:"main-header"},[o("el-dropdown",[o("img",{staticClass:"login-info-logo",attrs:{src:a("9d64")}}),o("i",{staticClass:"el-icon-caret-bottom"}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{nativeOn:{click:function(t){return e.signout(t)}}},[e._v("退出")])],1)],1)],1),o("el-main",[o("div",[o("router-view")],1)])],1)],1)},T=[],I={data:function(){return{activeIndex:this.$route.name,isCollapse:"true"===localStorage.getItem("isCollapse")}},methods:{signout:function(){var e=this,t=localStorage.getItem("token");t&&this.axios.post("/console/user/signOut").then(function(t){t.data;e.$message.success("退出成功!"),localStorage.setItem("token",""),e.$router.replace("/login")}).catch(this.serviceError)},toggleCollapse:function(){this.isCollapse=!this.isCollapse,localStorage.setItem("isCollapse",this.isCollapse)}}},D=I,V=(a("8e29"),Object(u["a"])(D,S,T,!1,null,null,null));V.options.__file="index.vue";var $=V.exports,O=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"video-list"},[o("el-row",{staticClass:"operator-header",attrs:{gutter:15}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{placeholder:"输入查询内容",clearable:""},model:{value:e.searchKeyWord,callback:function(t){e.searchKeyWord=t},expression:"searchKeyWord"}},[o("el-select",{staticClass:"input-with-select",attrs:{slot:"prepend",placeholder:"选择查询条件"},slot:"prepend",model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}},e._l(e.searchKeyOptions,function(e){return o("el-option",{key:e.vlaue,attrs:{label:e.label,value:e.value}})}),1)],1)],1),o("el-col",{attrs:{span:4}},[o("el-select",{attrs:{placeholder:"选择审核状态",clearable:""},model:{value:e.censorStatus,callback:function(t){e.censorStatus=t},expression:"censorStatus"}},e._l(e.checkOptions,function(e){return o("el-option",{key:e.vlaue,attrs:{label:e.label,value:e.value}})}),1)],1),o("el-col",{attrs:{span:9}},[o("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"-","start-placeholder":"创建日期","end-placeholder":"创建日期",align:"right"},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("el-col",{staticStyle:{"text-align":"right"},attrs:{span:3}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.loadData(1)}}},[e._v("搜索")])],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{data:e.list}},[o("el-table-column",{attrs:{type:"selection",width:"50"}}),o("el-table-column",{attrs:{label:"资源名称",width:"480",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-row",[o("el-col",{staticClass:"video-img",attrs:{span:9}},[o("div",{staticClass:"video-img-container",on:{click:function(a){e.play(t.row)}}},[o("img",{attrs:{src:t.row.coverUrl||a("3507")}}),"success"===t.row.censorStatus?o("img",{staticClass:"play-btn",attrs:{src:a("c4bf")}}):e._e()])]),o("el-col",{staticClass:"video-info",attrs:{span:15}},[o("el-row",{staticClass:"video-title"},[e._v(e._s(t.row.title))]),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频ID:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(t.row.videoId))])],1),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频时长:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(e.getVideoTime(t.row.duration)))])],1),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频大小:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(e.getFileSize(t.row.size)))])],1)],1)],1)]}}])}),o("el-table-column",{attrs:{label:"截图",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{trigger:"hover",width:"660"}},[o("el-row",{attrs:{gutter:10}},[e._l(t.row.snapshotList,function(e){return o("el-col",{attrs:{span:6}},[o("el-card",{staticClass:"screen-shot",attrs:{shadow:"never"}},[o("img",{attrs:{src:e}})])],1)}),o("el-col",{directives:[{name:"show",rawName:"v-show",value:t.row.snapshotList&&!t.row.snapshotList.length,expression:"scope.row.snapshotList && !scope.row.snapshotList.length"}],staticClass:"empty-data",attrs:{span:24}},[e._v("暂无截图")])],2),o("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("显示截图")])],1)]}}])}),o("el-table-column",{attrs:{label:"用户名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.user.userName)+"\n        ")]}}])}),o("el-table-column",{attrs:{label:"审核状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["fail"===t.row.censorStatus?o("el-tag",{attrs:{type:"danger"}},[e._v("审核不通过")]):"success"===t.row.censorStatus?o("el-tag",{attrs:{type:"success"}},[e._v("审核通过")]):"check"===t.row.censorStatus?o("el-tag",{attrs:{type:"warning"}},[e._v("待审核")]):o("el-tag",[e._v("审核中")])]}}])}),o("el-table-column",{attrs:{label:"转码状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["fail"===t.row.censorStatus?o("el-tag",{attrs:{type:"danger"}},[e._v("转码失败")]):"success"===t.row.censorStatus?o("el-tag",{attrs:{type:"success"}},[e._v("转码成功")]):"onTranscode"===t.row.censorStatus?o("el-tag",[e._v("转码中")]):o("el-tag",{attrs:{type:"info"}},[e._v("未转码")])]}}])}),o("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",disabled:"true"===t.row.isRecommend||"success"!==t.row.censorStatus},on:{click:function(a){e.recommend(t.row)}}},[e._v(e._s("true"===t.row.isRecommend?"已推荐":"推荐")+"\n          ")]),o("el-popover",{staticClass:"delete-propper",attrs:{placement:"top",width:"160"},model:{value:t.row.checkVisible,callback:function(a){e.$set(t.row,"checkVisible",a)},expression:"scope.row.checkVisible"}},[o("p",{staticClass:"check-confirm-text"},[e._v("选择审核操作")]),o("div",{staticClass:"check-confirm"},[o("el-button",{attrs:{plain:"",type:"primary",loading:t.row.ckeckPassLoading},on:{click:function(a){e.checkVideo(t.row,1)}}},[e._v("通过")]),o("el-button",{attrs:{plain:"",type:"danger"},on:{click:function(a){e.rejectVideo(t.row)}}},[e._v("屏蔽")])],1),o("el-button",{attrs:{slot:"reference",disabled:"onCensor"===t.row.censorStatus,type:"warning",loading:t.row.checkLoading},slot:"reference"},[e._v("审核")])],1),o("el-dropdown",{staticClass:"more-operator"},[o("el-button",[e._v("\n              更多"),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["fail"===t.row.transcodeStatus?o("el-dropdown-item",{nativeOn:{click:function(a){e.transVideo(t.row.videoId)}}},[e._v("转码")]):e._e(),o("el-dropdown-item",{nativeOn:{click:function(a){e.deleteVideo(t.row)}}},[e._v("删除")])],1)],1)]}}])})],1),o("el-row",{staticClass:"main-pagination"},[o("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20],"page-size":e.size,background:"",layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":function(t){e.loadData(1)},"current-change":e.loadData,"update:pageSize":function(t){e.size=t}}})],1),o("VodPlayer",{ref:"vodPlayer",attrs:{title:e.videoTitle,vid:e.videoId,description:e.videoDescription}}),o("RecommentVideo",{ref:"dialogRecomment",attrs:{video:e.recommendVideo},on:{loadData:e.loadData}})],1)},z=[],K=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"650px"},on:{"update:visible":function(t){e.visible=t},open:e.open,close:e.close}},[a("p",{staticClass:"video-description"},[e._v(e._s(e.description))]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"player-container",attrs:{id:"player-container"}})])},N=[],j=a("f499"),B=a.n(j),E=(a("ac6a"),{props:["title","vid","description"],data:function(){return{visible:!1,player:null,loading:!1}},methods:{open:function(){var e=this,t={videoId:this.vid};this.loading=!0,this.axios.get("/vodVideo/getVideoById",{params:t}).then(function(t){var a=t.data,o=a.data.playInfoList,s={};o.forEach(function(e){s[e.definition]=e.playURL}),s=B()(s),e.player=e.createPlayer(s)}).catch(this.serviceError).finally(function(){e.loading=!1})},close:function(){this.player&&this.player.dispose()},createPlayer:function(e){var t=new Aliplayer({id:"player-container",source:e,width:"100%",height:"400px",autoplay:!0},function(e){});return t}}}),L=E,P=(a("9544"),Object(u["a"])(L,K,N,!1,null,null,null));P.options.__file="VodPlayer.vue";var F=P.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"recommend",attrs:{title:"确定推荐吗?",visible:e.visible,width:"400px"},on:{"update:visible":function(t){e.visible=t},close:e.close}},[a("div",[a("p",{staticClass:"recomment-tip"},[e._v("选择推荐视频选项")]),a("el-checkbox",{attrs:{label:"窄带高清",border:""},model:{value:e.isNarrow,callback:function(t){e.isNarrow=t},expression:"isNarrow"}}),a("el-checkbox",{attrs:{label:"预热",border:""},model:{value:e.isCache,callback:function(t){e.isCache=t},expression:"isCache"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirm}},[e._v("确 定")])],1)])},M=[],W={props:["video"],data:function(){return{visible:!1,isNarrow:!0,isCache:!0,loading:!1}},methods:{confirm:function(){var e=this;this.loading=!0;var t=this.video,a=t.title,o=t.videoId,s=t.description,n=t.duration,i=t.coverUrl,r=t.size,l=t.tags,c=t.cateId,d=t.cateName,u=t.firstFrameUrl,p=t.transcodeStatus,f=t.snapshotStatus,v=t.censorStatus,m={title:a,videoId:o,description:s,duration:n,coverUrl:i,size:r,tags:l,cateId:c,cateName:d,firstFrameUrl:u,transcodeStatus:p,snapshotStatus:f,censorStatus:v};m.userId=this.video.user.userId,m.isNarrow=this.isNarrow,m.isCache=this.isCache,this.axios.post("/console/vod/recommendVideo",y.a.stringify(m)).then(function(t){t.data;e.$message.success("推荐成功!"),e.$emit("loadData"),e.visible=!1}).catch(this.serviceError).finally(function(){e.loading=!1})},close:function(){this.isNarrow=!0,this.isCache=!0}}},H=W,U=(a("7356"),Object(u["a"])(H,R,M,!1,null,null,null));U.options.__file="RecommendVideo.vue";var q=U.exports,A={components:{VodPlayer:F,RecommentVideo:q},data:function(){return{searchKeyOptions:[{label:"视频ID",value:"videoId"},{label:"用户ID",value:"userId"},{label:"用户名称",value:"userName"},{label:"视频标题",value:"title"}],searchKey:"",searchKeyWord:"",censorStatus:"",checkOptions:[{label:"审核中",value:"onCensor"},{label:"审核通过",value:"success"},{label:"待审核",value:"check"},{label:"审核不通过",value:"fail"}],createTime:"",pickerOptions:{shortcuts:[{text:"最近一天",onClick:this.pickerHandle()},{text:"最近一周",onClick:this.pickerHandle(7)},{text:"最近一个月",onClick:this.pickerHandle(30)}]},loading:!1,list:[],page:1,size:5,total:0,videoTitle:"",videoId:"",videoDescription:"",recommendVideo:null}},created:function(){this.loadData()},methods:{loadData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page,a={pageIndex:t,pageSize:this.size};this.searchKey&&this.searchKeyWord&&(a[this.searchKey]=this.searchKeyWord),this.censorStatus&&(a.censorStatus=this.censorStatus),this.createTime&&(a.startTime=this.getFormatDate(this.createTime[0]),a.endTime=this.getFormatDate(this.createTime[1])),this.page=t,this.loading=!0,this.axios.get("/console/vod/getVideos",{params:a}).then(function(t){var a=t.data,o=a.data;e.total=o.total,e.list=o.videoList}).catch(this.serviceError).finally(function(){e.loading=!1})},deleteVideo:function(e){var t=this;this.$msgbox({title:"消息",message:"确定删除吗?",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,s){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="删除中...",t.handleDelete(e,function(){s(),o.confirmButtonLoading=!1})):s()}}).catch(function(){})},handleDelete:function(e,t){var a=this,o=e.videoId,s=e.user.userId;this.axios.post("/console/vod/deleteVideoById",y.a.stringify({videoId:o,userId:s})).then(function(e){e.data;a.$message.success("删除成功!"),a.loadData()}).catch(this.serviceError).finally(function(){t&&t()})},recommend:function(e){this.recommendVideo=e,this.$refs.dialogRecomment.visible=!0},showCheckReject:function(){var e=this;this.$prompt("请输入屏蔽理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputErrorMessage:"请不要超过128个字"}).then(function(t){t.value;e.$message({})}).catch(function(){e.$message({})})},transVideo:function(e){var t=this;this.axios.post("/console/vod/submitTranscode",y.a.stringify({mediaId:e})).then(function(e){e.data;t.$message.success("转码成功!")}).catch(this.serviceError)},rejectVideo:function(e){var t=this;this.$msgbox({title:"消息",message:"确定屏蔽吗?",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,s){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="执行中...",t.checkVideo(e,0,function(){s(),o.confirmButtonLoading=!1})):s()}}).catch(function(){})},checkVideo:function(e,t,a){var o=this;e.ckeckPassLoading=1===t&&!0;var s=e.videoId,n={mediaId:s};n.status=1===t?"Normal":"Blocked",this.axios.post("/console/vod/createAudit",y.a.stringify(n)).then(function(t){var a=t.data;e.checkVisible=!1,o.$message.success(a.message),o.loadData()}).catch(this.serviceError).finally(function(){e.ckeckPassLoading=1===t&&!1,a&&a()})},computeTranscodeStatus:function(e){var t="";switch(e){case"onTranscode":t="转码中";break;case"success":t="转码成功";break;case"fail":t="转码失败";break}return t},play:function(e){var t=e.title,a=e.videoId,o=e.description,s=e.censorStatus;"success"===s&&(this.videoTitle=t,this.videoId=a,this.videoDescription=o,this.$refs.vodPlayer.visible=!0)},pickerHandle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=864e5*e;return function(e){var a=new Date,o=new Date;o.setTime(o.getTime()-t),e.$emit("pick",[o,a])}}}},J=A,Y=(a("6217"),Object(u["a"])(J,O,z,!1,null,null,null));Y.options.__file="index.vue";var G=Y.exports,Q=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"video-list"},[o("el-row",{staticClass:"operator-header",attrs:{gutter:15}},[o("el-col",{attrs:{span:8}},[o("el-input",{attrs:{placeholder:"输入查询内容",clearable:""},model:{value:e.searchKeyWord,callback:function(t){e.searchKeyWord=t},expression:"searchKeyWord"}},[o("el-select",{staticClass:"input-with-select",attrs:{slot:"prepend",placeholder:"选择查询条件"},slot:"prepend",model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}},e._l(e.searchKeyOptions,function(e){return o("el-option",{key:e.vlaue,attrs:{label:e.label,value:e.value}})}),1)],1)],1),o("el-col",{attrs:{span:9}},[o("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"-","start-placeholder":"推荐日期","end-placeholder":"推荐日期",align:"right"},model:{value:e.createTime,callback:function(t){e.createTime=t},expression:"createTime"}})],1),o("el-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.loadData(1)}}},[e._v("搜索")])],1)],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",attrs:{data:e.list}},[o("el-table-column",{attrs:{type:"selection",width:"50"}}),o("el-table-column",{attrs:{label:"资源名称",width:"480",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-row",[o("el-col",{staticClass:"video-img",attrs:{span:9}},[o("div",{staticClass:"video-img-container",on:{click:function(a){e.play(t.row.title,t.row.videoId,t.row.description)}}},[o("img",{attrs:{src:t.row.coverUrl||a("3507")}}),o("img",{staticClass:"play-btn",attrs:{src:a("c4bf")}})])]),o("el-col",{staticClass:"video-info",attrs:{span:15}},[o("el-row",{staticClass:"video-title"},[e._v(e._s(t.row.title))]),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频ID:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(t.row.videoId))])],1),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频时长:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(e.getVideoTime(t.row.duration)))])],1),o("el-row",[o("el-col",{attrs:{span:6}},[e._v("视频大小:")]),o("el-col",{attrs:{span:18}},[e._v(e._s(e.getFileSize(t.row.size)))])],1)],1)],1)]}}])}),o("el-table-column",{attrs:{label:"用户名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.user.userName)+"\n        ")]}}])}),o("el-table-column",{attrs:{label:"审核状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["fail"===t.row.censorStatus?o("el-tag",{attrs:{type:"danger"}},[e._v("审核不通过")]):"onCensor"===t.row.censorStatus?o("el-tag",[e._v("审核中")]):"check"===t.row.censorStatus?o("el-tag",{attrs:{type:"warning"}},[e._v("待审核")]):o("el-tag",{attrs:{type:"success"}},[e._v("审核通过")])]}}])}),o("el-table-column",{attrs:{label:"窄带高清转码状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["fail"===t.row.narrowTranscodeStatus?o("el-tag",{attrs:{type:"danger"}},[e._v("转码失败")]):"success"===t.row.narrowTranscodeStatus?o("el-tag",{attrs:{type:"success"}},[e._v("转码成功")]):o("el-tag",[e._v("转码中")])]}}])}),o("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{loading:t.row.warmLoading,type:"primary",disabled:!1},on:{click:function(a){e.warmVideo(t.row)}}},[e._v("预热\n          ")]),o("el-dropdown",{staticClass:"more-operator"},[o("el-button",[e._v("\n              更多"),o("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},["fail"===t.row.narrowTranscodeStatus?o("el-dropdown-item",{nativeOn:{click:function(a){e.transNarrowVideo(t.row.videoId)}}},[e._v("窄带高清转码")]):e._e(),o("el-dropdown-item",{nativeOn:{click:function(a){e.deleteVideo(t.row)}}},[e._v("取消推荐")])],1)],1)]}}])})],1),o("el-row",{staticClass:"main-pagination"},[o("el-pagination",{attrs:{"current-page":e.page,"page-sizes":[5,10,20],"page-size":e.size,background:"",layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":function(t){e.loadData(1)},"current-change":e.loadData,"update:pageSize":function(t){e.size=t}}})],1),o("VodPlayer",{ref:"vodPlayer",attrs:{title:e.videoTitle,description:e.videoDescription,vid:e.videoId}}),o("RecommentVideo",{ref:"dialogRecomment",attrs:{video:e.recommendVideo},on:{loadData:e.loadData}})],1)},X=[],Z={components:{VodPlayer:F,RecommentVideo:q},data:function(){return{searchKeyOptions:[{label:"视频ID",value:"videoId"},{label:"用户ID",value:"userId"},{label:"用户名称",value:"userName"},{label:"视频标题",value:"title"}],searchKey:"",searchKeyWord:"",checkOptions:[{label:"审核中",value:"onCensor"},{label:"审核通过",value:"success"},{label:"待审核",value:"check"},{label:"审核不通过",value:"fail"}],createTime:"",pickerOptions:{shortcuts:[{text:"最近一天",onClick:this.pickerHandle()},{text:"最近一周",onClick:this.pickerHandle(7)},{text:"最近一个月",onClick:this.pickerHandle(30)}]},loading:!1,list:[],page:1,size:5,total:0,videoTitle:"",videoId:"",videoDescription:"",recommendVideo:null}},created:function(){this.loadData()},methods:{loadData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.page,a={pageIndex:t,pageSize:this.size};this.searchKey&&this.searchKeyWord&&(a[this.searchKey]=this.searchKeyWord),this.createTime&&(a.startTime=this.getFormatDate(this.createTime[0]),a.endTime=this.getFormatDate(this.createTime[1])),this.page=t,this.loading=!0,this.axios.get("/console/vod/getRecommendVideos",{params:a}).then(function(t){var a=t.data,o=a.data;e.total=o.nowTotal,e.list=o.videoList}).catch(this.serviceError).finally(function(){e.loading=!1})},deleteVideo:function(e){var t=this;this.$msgbox({title:"消息",message:"确定取消推荐吗?",type:"warning",showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(a,o,s){"confirm"===a?(o.confirmButtonLoading=!0,o.confirmButtonText="操作中...",t.handleDelete(e,function(){s(),o.confirmButtonLoading=!1})):s()}}).catch(function(){})},handleDelete:function(e,t){var a=this,o=e.videoId,s=e.user.userId;this.axios.post("/console/vod/deleteRecommendById",y.a.stringify({videoId:o,userId:s})).then(function(e){e.data;a.$message.success("删除成功!"),a.loadData()}).catch(this.serviceError).finally(function(){t&&t()})},warmVideo:function(e){var t=this,a={objectPath:"https://alivc-demo-vod.aliyuncs.com/"+e.fileUrl};e.warmLoading=!0,this.axios.post("/console/vod/pushObjectCache",y.a.stringify(a)).then(function(e){e.data;t.$message.success("预热成功!")}).catch(this.serviceError).finally(function(){e.warmLoading=!1})},transNarrowVideo:function(e){var t=this;this.axios.post("/console/vod/submitTabTranscode",y.a.stringify({mediaId:e})).then(function(e){e.data;t.$message.success("转码成功!")}).catch(this.serviceError)},play:function(e,t,a){this.videoTitle=e,this.videoId=t,this.videoDescription=a,this.$refs.vodPlayer.visible=!0},pickerHandle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=864e5*e;return function(e){var a=new Date,o=new Date;o.setTime(o.getTime()-t),e.$emit("pick",[o,a])}}}},ee=Z,te=Object(u["a"])(ee,Q,X,!1,null,null,null);te.options.__file="index.vue";var ae=te.exports;i["default"].use(h["a"]);var oe=[{name:"login",path:"/login",component:C},{path:"/videos",component:$,children:[{name:"list",path:"",component:G},{name:"recommend",path:"recommend",component:ae}]},{path:"*",redirect:"/videos"}],se=new h["a"]({routes:oe}),ne=a("5c96"),ie=a.n(ne),re=(a("0fae"),function(e){console.log(e);var t="请求出错!";e.data&&(t=e.data.message),this.$message.error(t)}),le=function(e){if(e){var t=Math.round(e),a=Math.floor(t/3600),o=Math.floor((t-3600*a)/60),s=t-3600*a-60*o;return o<10&&(o="0"+o),s<10&&(s="0"+s),0===a?o+":"+s:a+":"+o+":"+s}return 0},ce=function(e){var t=e/1024/1024;return Math.round(100*t)/100+"M"},de=function(e){var t=e.getFullYear(),a=e.getMonth()+1,o=e.getDate(),s=e.getHours();s=s<10?"0"+s:s;var n=e.getMinutes();n=n<10?"0"+n:n;var i=e.getSeconds();return i=i<10?"0"+i:i,t+"-"+a+"-"+o+" "+s+":"+n+":"+i},ue={methods:{serviceError:re,getVideoTime:le,getFileSize:ce,getFormatDate:de}};i["default"].mixin(ue),i["default"].use(ie.a,{size:"mini"}),m.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",i["default"].prototype.axios=m.a,m.a.interceptors.request.use(function(e){var t=localStorage.getItem("token");return"get"===e.method?"object"===Object(n["a"])(e.params)?e.params.consoleToken=t:e.params={consoleToken:t}:"post"===e.method&&(void 0===e.data?e.data="consoleToken=".concat(t):e.data+="&consoleToken=".concat(t)),e}),m.a.interceptors.response.use(function(e){return 500==e.data.code||401==e.data.code?s.a.reject(e):403==e.data.code?(localStorage.setItem("token",""),se.replace("/login"),s.a.reject(e)):e}),se.beforeEach(function(e,t,a){return localStorage.getItem("token")&&"login"===e.name?a("/videos"):localStorage.getItem("token")||"login"===e.name?a():a("/login")}),i["default"].config.productionTip=!1,new i["default"]({router:se,render:function(e){return e(f)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var o=a("5e27"),s=a.n(o);s.a},"5e27":function(e,t,a){},6217:function(e,t,a){"use strict";var o=a("19e6"),s=a.n(o);s.a},7356:function(e,t,a){"use strict";var o=a("224f"),s=a.n(o);s.a},"8e29":function(e,t,a){"use strict";var o=a("de44"),s=a.n(o);s.a},9544:function(e,t,a){"use strict";var o=a("36fb"),s=a.n(o);s.a},"9d64":function(e,t,a){e.exports=a.p+"img/logo.2409e6d8.png"},a41b:function(e,t,a){},c4bf:function(e,t,a){e.exports=a.p+"img/play.082454ba.png"},de44:function(e,t,a){}});